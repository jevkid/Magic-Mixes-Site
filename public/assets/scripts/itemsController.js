{"v":4,"t":["var itemsController = function(){\n\n\tvar module = {};\n\n\tmodule.init = function(){\n    itemsController.main();\n    itemsController.featured();\n    itemsController.search();\n\t};\n\n\tmodule.main = function(){\n\t\tvar apiKey = 'tz1wjg6wvmvezr1o3xv4rom6';\n\t\tvar shopName = 'MagicMixes';\n\n\t\tvar template = helpers.compileRactive({\n\t\t\ttemplate: 'items',\n\t\t\toutlet: 'items',\n\t\t\tdata: {\n\t\t\t\tapiKey: 'tz1wjg6wvmvezr1o3xv4rom6',\n\t\t\t\tshopName: 'MagicMixes'\n\t\t\t}\n\t\t});\n\n\t\tvar category = window.location.search.split('?')[1];\n    $.ajax({\n      url: \"https://openapi.etsy.com/v2/shops/\" + template.get('shopName') + \"/listings/active.js?api_key=\" + template.get('apiKey') + \"&shop_section_id=\" + category + \"&includes=MainImage&fields=url,price,title,shop_section_id,description&limit=100\",\n      dataType: 'jsonp',\n      success: function(response){\n        template.set('items', response);\n      },\n    });\n\n    template.on('loadImages', function(target, listingId){\n    \ttemplate.set('count', 0);\n    \t$.ajax({\n\t      url: \"https://openapi.etsy.com/v2/listings/\" + listingId + \"/images.js?api_key=\" + template.get('apiKey'),\n\t      dataType: 'jsonp',\n\t      success: function(response){\n\t        template.set('images', response.results);\n\t        template.set('max', response.results.length-1);\n\t      },\n\t    });\n    });\n\n    template.on('next', function(){\n    \tvar max = template.get('max');\n    \tvar count = template.get('count');\n    \tif(count === (max - 1)){\n    \t\ttemplate.set('count', 0);\n    \t} else {\n    \t\ttemplate.add('count');    \t\n    \t}\n    });\n\n    template.on('previous', function(){\n    \tvar max = template.get('max');\n    \tvar count = template.get('count');\n    \tif(count === 0){\n    \t\ttemplate.set('count', max);\n    \t} else {\n    \t\ttemplate.subtract('count');    \t\n    \t}\n    });\n\n\t};\n\n\tmodule.featured = function(){\n\t\tvar apiKey = 'tz1wjg6wvmvezr1o3xv4rom6';\n\t\tvar shopName = 'MagicMixes';\n\n\t\tvar featuredTemplate = helpers.compileRactive({\n\t\t\ttemplate: 'featured',\n\t\t\toutlet: 'featured',\n\t\t\tdata: {\n\t\t\t\tapiKey: 'tz1wjg6wvmvezr1o3xv4rom6',\n\t\t\t\tshopName: 'MagicMixes'\n\t\t\t}\n\t\t});\n\n    $.ajax({\n      url: \"https://openapi.etsy.com/v2/shops/\" + featuredTemplate.get('shopName') + \"/listings/featured.js?api_key=\" + featuredTemplate.get('apiKey') + \"&includes=MainImage&fields=url,price,title,shop_section_id,description&limit=4\",\n      dataType: 'jsonp',\n      success: function(response){\n        console.log(response);\n        featuredTemplate.set('items', response);\n      },\n    });\n\n    featuredTemplate.on('loadImages', function(target, listingId){\n    \tfeaturedTemplate.set('count', 0);\n    \t$.ajax({\n\t      url: \"https://openapi.etsy.com/v2/listings/\" + listingId + \"/images.js?api_key=\" + featuredTemplate.get('apiKey'),\n\t      dataType: 'jsonp',\n\t      success: function(response){\n\t        featuredTemplate.set('images', response.results);\n\t        featuredTemplate.set('max', response.results.length-1);\n\t      },\n\t    });\n    });\n\n  };\n\n  module.search = function(){\n\t\tvar apiKey = 'tz1wjg6wvmvezr1o3xv4rom6';\n\t\tvar shopName = 'MagicMixes';\n\n\t\tvar searchTemplate = helpers.compileRactive({\n\t\t\ttemplate: 'search',\n\t\t\toutlet: 'search',\n\t\t\tdata: {\n\t\t\t\tapiKey: 'tz1wjg6wvmvezr1o3xv4rom6',\n\t\t\t\tshopName: 'MagicMixes'\n\t\t\t}\n\t\t});\n\n\t\tsearchTemplate.on('viewToggle', function(target){\n\t\t\tsearchTemplate.toggle(target.keypath + '.viewDetails');\n\t\t});\n\n\t\tvar query = window.location.search.split('?')[1];\n    $.ajax({\n      url: \"https://openapi.etsy.com/v2/shops/\" + searchTemplate.get('shopName') + \"/listings/active.js?api_key=\" + searchTemplate.get('apiKey') + \"&keywords=\" + query + \"&includes=MainImage&fields=url,price,title,shop_section_id,description&limit=100\",\n      dataType: 'jsonp',\n      success: function(response){\n        searchTemplate.set('items', response);\n      },\n    });\n\n    searchTemplate.on('viewAll', function(){\n    \t$.ajax({\n\t      url: \"https://openapi.etsy.com/v2/shops/\" + searchTemplate.get('shopName') + \"/listings/active.js?api_key=\" + searchTemplate.get('apiKey') + \"&includes=MainImage&fields=url,price,title,shop_section_id,description&limit=100\",\n\t      dataType: 'jsonp',\n\t      success: function(response){\n\t      \tconsole.log(response);\n\t        searchTemplate.set('items', response);\n\t      },\n\t    });\n    });\n\n\t};\n\n  return module;\n\n}();\n\n$(document).ready(function() {\n  itemsController.init();\n});\n"]}